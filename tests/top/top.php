<?php
/**
 * Created by PhpStorm.
 * User: vitalykhy
 * Date: 21.09.16
 * Time: 17:36
 */

include_once (__DIR__ . '/../../lib/common/common.php');
common_inc('test');
common_inc('filter/top', 'top');

/**
 * Test @see top_get().
 *
 * @param string $type @see top_get().
 * @param array $where @see top_get().
 * @return bool
 */
function TestTopGet($type = 'link', $where = [], $result = 0)
{
    $rs = top_get($type, $where);
    $c = 0;
    while($ar = mysqli_fetch_assoc($rs))
        $c++;

    if($c == $result)
        return true;
    else
        return false;
}

TestGetIteration('TestTopGet', ['link', [
    'from' => 1463000400,
    'to' => 1463950800,
    'IN' => [
        'domain' => [1,7]
    ]
], 100], true);

TestGetIteration('TestTopGet', ['region', [
    'from' => 1463000400,
    'to' => 1463950800,
    'IN' => [
        'domain' => [1,7]
    ],
    'city' => 'Москва'
], 100], true);

TestGetIteration('TestTopGet', ['provider', [
    'from' => 1463000400,
    'to' => 1463950800,
    'IN' => [
        'domain' => [1,7]
    ],
    'provider' => 'Moscow Local Telephone Network (OAO MGTS)'
], 100], true);

$uuid = [
    '146211561404320202847774815492',
    '146211561498586323248106054960',
    '146211203197359068182366900140',
    '146211562111941377818281762300',
    '14621156214326377839064225554',
    '146211561590447637426154688000',
    '146211556013989122668560594320',
    '14619167808411175196515297338.8',
    '146211572109392782655148766930',
    '14621156232019160538855940104',
    '14619144011144596222238615155',
    '146211199265787187777056397490',
    '146211562302555447013233788310',
    '146211562283552349055116729336',
    '146211562391421834723977372052',
    '146216601483637613543658517304',
    '146211565735540885491150904940',
    '146211560964095062921770655020',
    '146211565532035055028623901308',
    '146211572907498070828989148140',
    '146211563154293638431699134290',
    '146189213679258804782400103120',
    '146211863197389808232047844340',
    '146211576720662598510039970280',
    '146211097613217502261364581994',
    '146210543947482890604902058830',
    '146211562811418012907984666526',
    '146211562723849239652487449340',
    '146211458689164107754985748720',
    '146211551564085229680173123980',
    '14621156072345711274508735215',
    '146211158203821399387926794588',
    '146211562794511477335480138152',
    '146211279200190556297054328340',
    '146208699844612911284675335244',
    '146211563397524789050128310920',
    '146187574028223718149401247500',
    '146166315274450631586659926420',
    '146211566476035490534478425452',
    '146211558311031308789702914332',
    '146211563633685213325639405250',
    '146211503866686944098119646560',
    '146211303975013808102220610468',
    '146192221907778745782879762800',
    '146211563486231131610755766360',
    '146162880006073723683902062480',
    '146187507101958892632102897630',
    '146182022716818223406127960424',
    '14621157807133696545542481400',
    '146211562641741654978296719490',
    '146211512044821239891684699484',
    '146211565334333885829336941244',
    '146211570349936669145827181640',
    '146211564775170185637332977820',
    '146211562834447102812421508136',
    '146211570366521382533200085164',
    '146211564900134010254032909870',
    '146211564223980309355696922170',
    '146182600352448135916260071096',
    '146211548924943586396377810280',
    '146211566024330719565226691990',
    '146211565234760165011793268830',
    '146211565374171644524593096670',
    '146211579207931648265480941396',
    '146210225223160543224331977180',
    '146211516846360393809001623656',
    '146194143888193718945293906800',
    '14621134661678669747558805529',
    '146211565919660873107868246740',
    '146208521826334418689087033270',
    '146211421654423413712541995756',
    '146211566003472721827635541550',
    '14621118835411909958610786288.8',
    '146211360396394738422986119980',
    '146211566525033522804050585030',
    '146185245553428972385182301684',
    '146185228250558548927287683380',
    '146211050909489390598027966910',
    '146211566792052739521418698136',
    '146211566732145526117100402080',
    '146211561767835709937801584600',
    '14621156677918795299823395908',
    '146171111133287704127194363120',
    '146211567025051377123332028000',
    '146211567787288603618275374180',
    '146187079660060184759788241450',
    '146211588495128522227238863708',
    '146210134212242881694417941784',
    '142009641878034895378188230096',
    '146201933941493189088720828290',
    '146211206954523564357217401268',
    '146211567545559409489738754930',
    '146211589032316534534445963800',
    '146211455333999456319593155220',
    '146211567986938958441642529530',
    '146220199764391448072670027620',
    '146211568174556017007469199600',
    '146211210228519976249422282000',
    '146197258963587489437032490980',
    '146211568495196236156219156020',
    '146211576390915134073654189706',
    '146211562888463055524253286424',
    '146211486202687648530950760450',
    '146211579172190259742108173660',
    '146211285276837111043464392424',
    '146211471821634362247417422950',
    '146211416892270910511072725060',
    '146211416283545761797404374904',
    '146205040954972206379293775230',
    '146185914929462408135100433970',
    '146211524815071947306684220000',
    '146211569233943156987609141600',
    '146211564072699585753912106160',
    '146211221814590788532256798030',
    '146202702453145900144777260720',
    '146211141116355477596167474984',
    '146211573180317002580012194812',
    '146211494070383597303484566510',
    '146211570826911290071718394756',
    '146194867593093496103747650980',
    '146201997334050387771870009600',
    '146210627591283210133225657040',
    '146210981054440279391361400490',
    '146207982942914411327620450432',
    '14620180303545845900666888404',
    '146211297863029427799908444284',
    '146211569540351027185521683640',
    '146211210922124778819868840164',
    '146210748353587753426284391870',
    '146208010987028950226408991010',
    '146211571266983904612303500350',
    '14621157218501935507417843007.5',
    '146185974821079580509732477360',
    '146211571208193713691880272050',
    '146211259663036705046379938720',
    '146211603274841726426244713370',
    '146174814973281871131662950290',
    '146211573748291421133533682350',
    '146211571241850284598791040480',
    '14621158609531999747077934444',
    '146211569554855843500078695400',
    '146195023127098645665693904850',
    '146211034380162882951253634810',
    '146211571730161316620418801900',
    '14621157091905485782329924405',
    '146211570731123077586006367336',
    '146211626982320508201420307160',
    '146210037087760236459492285064',
    '146211572403154932318364724110',
    '146211572385945186770123753740',
    '146183096785714656378493897204',
    '14621157244477332652512942095',
    '146211572445328907658808257280',
    '146211572446941444481376739144',
    '146211205452554881915966104296',
    '146211210194742146432166548870',
    '146211571653243016198230907320',
    '146211571929822585048715324764',
    '146211572823640606576623395090',
    '146211572967015648103179410100',
    '146211569467439055702900141710',
    '146211573282998969679101548700',
    '146211573456896301792543060980',
    '146211463580618770122551359236',
    '146211573266379669308266602460',
    '146211573401996529930158503860',
    '146211574475649103423958961570',
    '146211573644591105038706721710',
    '146202581631278821313937709490',
    '146211471338566041628467526104',
    '146207619511541680284147150820',
    '146211207513074425706545628960',
    '146211574163441741418142889010',
    '146211573918087593379684098160',
    '146159790509133949383072465800',
    '146187865006572673877175917530',
    '146207541784265794181773402664',
    '146211579517932881007040850820',
    '146211574655229510651936703956',
    '146211538983783282271958887580',
    '146211574153622247944517497596',
    '146211177578457419667355359930',
    '146211415552384156705101555790',
    '146208107340985033762711100290',
    '146211575307469122674985219336',
    '146211575848829827787703500784',
    '146219853796190110668856487600',
    '146211215005564493064815178510',
    '146185033144586845628519555400',
    '146211493389224485952710977508',
    '146211575538512953352999092182',
    '146207295289453431542531805600',
    '146201958714135943032766737028',
    '146205483207081319301715120670',
    '146199953885974704712365270370',
    '146211576686898867018171586100',
    '146211578717487703528325073420',
    '146211576033674281913973391060',
    '146210814310615316484938375652',
    '146201833474444965441937611820',
    '146211576237874106409866362820',
    '146211578060084364833027985650',
    '146211576078357004029520410990',
    '146211104571117948322046101472',
    '146211576571743101723655126990',
    '146211209303212413207453816034',
    '146204875930729146031723009804',
    '146219854807910897743373492896',
    '14621157688515869653504773603',
    '146195679124298046546708980340',
    '146211577010299154554423876110',
    '146211576626740832342237961176',
    '146187449835225775520073085812',
    '146211577319410842714661815222',
    '146211577520313163475542958380',
    '146211577570455346154913381590',
    '14621157767343508565398995045',
    '146211577269865117509511241800',
    '146211577775975466014195187330',
    '146211217570960439606382999320',
    '146184424470929640570055241744',
    '14621157885074002755044241024',
    '146211580862873550650384166990',
    '146211579078265829215128906070',
    '146211579101039893973851576450',
    '146211540309564661523269710216',
    '146211592293932779509294778108',
    '146211465005311161763382957846',
    '146211579626492613222263753400',
    '146211578005099200200748953310',
    '146211580448992588088816705390',
    '146211579939187118898106650930',
    '146211323855516814182984961668',
    '146204393596569834980519008970',
    '146211580088640715334836535280',
    '14621126272084280167911201715.5',
    '146195702418233334422530606388',
    '146187254465010615084321994516',
    '146211588113636380694189130380',
    '146211256184126819797931239010',
    '146211587045281768334337327760',
    '146211089399855384592113652540',
    '146211580366226279110754489772',
    '146211585291843373371800466230',
    '14621158325046240085582248867',
    '146211582518736581506612484680',
    '146211581190241908971200761736',
    '146211581384530123740714043380',
    '146211581419189276455598883330',
    '135891885312548541704821400344',
    '14621111266235409462237185036',
    '146211200968752658913885264800',
    '146209696752370241712028846590',
    '14621158207127937414105981588',
    '14621158769511872116153376257.5',
    '14621158281182138704910669053.8',
    '146211581909256388722541452350',
    '146211581952424043640210095750',
    '146198019339350170717732631930',
    '146211581543820313507713761748',
    '146211504837747915908470422130',
    '14621158240765202894272883762',
    '146192604719280950844357721500',
    '132538171391917140325228683650',
    '146211590509344445745933493900',
    '146211583540438215774841381340',
    '146211583126947398948646150530',
    '146211558230370258828136138616',
    '146211583087072450715675950050',
    '146211582736141545066342115190',
    '146211221022696366125668416320',
    '146211583273569592227251268920',
    '146211583533877316182779567230',
    '146183012899236962616653181620',
    '146200840601676629840698615420',
    '146211584608155591268488205970',
    '146211585417514495333048530756',
    '146187987625112663476847509720',
    '146183541621310228747222572566',
    '146208595548140085030195067930',
    '146211583773130667915212349670',
    '146211237318418091386677735956',
    '146211593840954556173465184440',
    '146214101120875671058846637600',
    '146211217039772082667984068400',
    '146211584362683358053932897740',
    '146196066494575059518404304980',
    '146211244999276578290085308260',
    '146211584643822618740572282880',
    '146211215294096053418259902350',
    '146211584737851173260831274100',
    '146211587589241649313059487420',
    '146211493182723754780192697.39',
    '146211585312018759309005490876',
    '146209337319281343443831428880',
    '146211584754616083498739906132',
    '14621124307663818471962586045.5',
    '146207707060120504615044953890',
    '146211585773116904823263290746',
    '146211585354997481944714672860',
    '146211585250165351327277527160',
    '146202465558729719442129135132',
    '146211585527938961863308213650',
    '146211585872586596498239863840',
    '146211586034990287282593373200',
    '146211585983186272633261978620',
    '146211192779070622394094243650',
    '146210123777653520453306174210',
    '146211585563984840516336220780',
    '146211585966363409264519652376',
    '146211233547316721897908622906',
    '146211214610347131787403486670',
    '146211582704976396024731275300',
    '146211586567115787122149848266',
    '146211585605518942785565741360',
    '146211157169820889774244278668',
    '14621158743949326580748893320',
    '146211587291458239018311674030',
    '146211368980421307929162925300',
    '146211585975338476202905659544',
    '146186016684846600110015369770',
    '146211587900614791149529628456',
    '146211588298868265841118450776',
    '146186297864968633444630540904',
    '14621159572318092245689833666',
    '146211588108326699736644513904',
    '146211587981458744784559520616',
    '146211588273512077670963481068',
    '146211584497516699451476382816',
    '146211588545146113093800992720',
    '146211588680648127867234870790',
    '146211588848275282847159542140',
    '146209924660939845331455580890',
    '146211362341612613410851918160',
    '1462115774235248551135882735.25',
    '146211589140078870692856464350',
    '146211588996722589590819552540',
    '146211588992588370892126113180',
    '146211562200481203333987939600',
    '146211514684145646339690583670',
    '146211589164847878333584147704',
    '146211584304199340268433244640',
    '146211589198768888596119359140',
    '146211589259753462569399765040',
    '146211586856065871384086880770',
    '146186996051522399807864731036',
    '146211589884433249466766082692',
    '146161261828311776466235965378',
    '146211589462950143746878313020',
    '146211589755111958294664509594',
    '146186480199622519928674329616',
    '14621158955374853444016656838',
    '14621158971405311948317103088',
    '146185282325467481181676478240',
    '146211589988254850559867918490',
    '146211228230867698817490600050',
    '1462115905527935426255839511',
    '14621159075828500381372869015',
    '146211592176325278712110593916',
    '146211502750884703825096194990',
    '146211557415415354492461531594',
    '146209833171536448189556611040',
    '146211591208327968519477379828',
    '146184208096159351024533159416',
    '146211602288412105929316021502',
    '146211595162886140020442694850',
    '146211591066759496181663221416',
    '146211589541670325631912671530',
    '146211591252876238847966305900',
    '146209105594244426815720627190',
    '14621159077843312108687275594.5',
    '146211593264612042313130527770',
    '146211591217484415829461067920',
    '146209839920717551794046181456',
    '146210388677487762755050769470',
    '146211592006963420992093031080',
    '146211591935566511515155434610',
    '146211592554541783903860314630',
    '146211592160043802995498841096',
    '146186906933213176024953183240',
    '146219511059936175794363940070',
    '146211233389757662010635299810',
    '146211254106428194090374745428',
    '146211592872373505817332012640',
    '146211592901364849391602911060',
    '146160544975288417645916342740',
    '146211461190024497122168086216',
    '146210720012985517888930724780',
    '146209163372736417065047610520',
    '146211592965260246996185742320',
    '146200562725315367397898808122',
    '14620104803492860889235831321',
    '146211370802428065629290856364',
    '146211592632547909757378511130',
    '146211593568353960028151050210',
    '146211593703948098660842515530',
    '146211593879377606229817398750',
    '146204251354653203305686686696',
    '146211593432757627544112198700',
    '146211593961010320545004150106',
    '146211161934237613011696082950',
    '146188132615224949581218429760',
    '14621159409273606128743353065.5',
    '146211594817899788181134499620',
    '146211593335723352389892675520',
    '14621123999647677218932478036',
    '146211594234971179007232897896',
    '146211485267710380280110985040',
    '146211595159714547247323207558',
    '1462115968063328048314534257.2',
    '146211287139754000918830076584',
    '146213029206331154846330173310',
    '146211595392139104998293303120',
    '146211595612238569428516285290',
    '146211424711558699555642907240',
    '146211595520776484450368047070',
    '146211595793682362164739306350',
    '146211594395470097491221703890',
    '146207952313067545479420018870',
    '146211520930689911297868900930',
    '146211594934687942461911035730',
    '146202363415947377156625956580',
    '146211595950939785124781821050',
    '146209977210422700797638388748',
    '146211596578170746763516217470',
    '146210043316515023379108275736',
    '146202621876748784407554194330',
    '146211544273623084456348264644',
    '146211597294133192824316211044',
    '146211597324833800309710204600',
    '146211598680753528953516987180',
    '146211389474027105644880793988',
    '14620938391278668745401719891',
    '146211600713966603195530421990',
    '146211600669885357507491787330',
    '146211595742684293292113579800',
    '146211597771067957919766195120',
    '146211247728220465914928354324',
    '146220229606287485907576046880',
    '146211597566642730488559388104',
    '146211597738175090649879712320',
    '146211597646277024075753556260',
    '146211598385431972211324913370',
    '146196255653719376927590928972',
    '146211599208824127780473384656',
    '146211608616837654572841711340',
    '146203521708147283698608957784',
    '146211241701845348207766431140',
    '146211598718286112914304249000',
    '146193092694597653341972906140',
    '146211586512692047144123353070',
    '146213133160270404926511940910',
    '146210105298169845947157591580',
    '146197440006049599735508672900',
    '146211600969239053692086599770',
    '146211598296656177125588879816',
    '146211600212213495784648694098',
    '146211218095092501678959968400',
    '146211599871034931706010115692',
    '146211600362995933649155623330',
    '146211600918811964843980967998',
    '146211597998346739141200669110',
    '146183440593811283108953356624',
    '14621160112217664561473603482',
    '146211601005375181088806130000',
    '146196892306145160625483991380',
    '146211601253419241372156172210',
    '146211223525419607009875381976',
    '146211601253360317156370729210',
    '146211602431012182546104927794',
    '146211421443121200398137569720',
    '146211241293242245335908318340',
    '146211601355239619365776889020',
    '146211601635838074030401185150',
    '146211548706268603413621895016',
    '146211602071786925595147727550',
    '146211262107041139055146572190',
    '146211599975766405177093110980',
    '146182417769887139475703669120',
    '146211601934686986933752466640',
    '146211602374897463294524240900',
    '146206916902698017234600847000',
    '146211222761829280205519604720',
    '146202881445695594917051494130',
    '146159674692064342259080149230',
    '146196042758722034929086615916',
    '146211602697017192315962165594',
    '146211537708238161958681631280',
    '146211244557586036762654570740',
    '146211455973699804126780017730',
    '146207861960311402536556124688',
    '146211560027570302492023632104',
    '14620408074289658607887104154',
    '146211602879951121600818667030',
    '146211602052087356265955923980',
    '146211604100578344564787751700',
    '146211603390390621798821593230',
    '146211603242728228199762002924',
    '146194709780178163805446795280',
    '146211095215735611416668623776'
];

TestGetIteration('TestTopGet', ['cross', [
    'from' => 1463000400,
    'to' => 1463950800,
    'IN' => [
        'uuid' => $uuid
    ]
], 43], true);

TestGetIteration('TestTopGet', ['crossCity', [
    'from' => 1463000400,
    'to' => 1463950800,
    'IN' => [
        'uuid' => $uuid
    ]
], 9], true);

TestGetIteration('TestTopGet', ['crossProvider', [
    'from' => 1463000400,
    'to' => 1463950800,
    'IN' => [
        'uuid' => $uuid
    ]
], 9], true);